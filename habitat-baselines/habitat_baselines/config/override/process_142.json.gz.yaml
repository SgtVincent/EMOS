# @package _global_
defaults:
- /benchmark/multi_agent: config_fetch_stretch_manipulation
- /habitat_baselines: habitat_baselines_rl_config_base
- /habitat/simulator/sim_sensors@habitat_baselines.eval.extra_sim_sensors.third_rgb_sensor: third_rgb_sensor
- /habitat_baselines/rl/policy/obs_transforms@habitat_baselines.rl.policy.agent_0.obs_transforms.add_virtual_keys:
  - add_virtual_keys_base
- /habitat_baselines/rl/policy/obs_transforms@habitat_baselines.rl.policy.agent_1.obs_transforms.add_virtual_keys:
  - add_virtual_keys_base
- /habitat_baselines/rl/policy@habitat_baselines.rl.policy.agent_0: hl_fixed
- /habitat_baselines/rl/policy@habitat_baselines.rl.policy.agent_1: hl_fixed
- ? /habitat_baselines/rl/policy/hierarchical_policy/defined_skills@habitat_baselines.rl.policy.agent_0.hierarchical_policy.defined_skills
  : oracle_skills_multi_agent
- ? /habitat_baselines/rl/policy/hierarchical_policy/defined_skills@habitat_baselines.rl.policy.agent_1.hierarchical_policy.defined_skills
  : oracle_skills_multi_agent
- /habitat/task/lab_sensors:
    # For the oracle navigation
  - has_finished_oracle_nav
  - all_predicates
- _self_


habitat_baselines:
  verbose: false
  trainer_name: ddppo
  updater_name: HRLPPO
  distrib_updater_name: HRLDDPPO
  torch_gpu_id: 0
  video_fps: 30
  video_dir: video_dir/manipulation_new

  num_environments: 1
  num_updates: -1
  total_num_steps: 1e8
  log_interval: 1
  num_checkpoints: 10
  force_torch_single_threaded: true
  eval_keys_to_include_in_name: [pddl_success]
  load_resume_state_config: false
  rollout_storage_name: HrlRolloutStorage

  evaluate: true
  evaluator:
    _target_: habitat_baselines.rl.multi_agent.habitat_mas_evaluator.HabitatMASEvaluator

  image_dir: video_dir/image_dir/

  eval:
    should_load_ckpt: false
    video_option: [disk]
    image_option: []
    json_option: [disk]
    video_option_new: true
    episode_stored:
    - episode_id: 137
      sample_frame:
      - - 1
        - 0
      - - 21
        - 0
      - - 41
        - 0
      - - 46
        - 0
      - - 148
        - 0
      - - 168
        - 0
      - - 188
        - 0
      - - 208
        - 0
      - - 228
        - 0
      - - 248
        - 0
      - - 268
        - 0
      - - 288
        - 0
      - - 308
        - 0
    - episode_id: 44
      sample_frame:
      - - 1
        - 0
      - - 21
        - 0
      - - 41
        - 0
      - - 55
        - 0
      - - 157
        - 0
      - - 177
        - 0
      - - 197
        - 0
      - - 217
        - 0
      - - 237
        - 0
      - - 257
        - 0
      - - 277
        - 0
      - - 291
        - 0
    - episode_id: 126
      sample_frame:
      - - 1
        - 0
      - - 21
        - 0
      - - 41
        - 0
      - - 61
        - 0
      - - 81
        - 0
      - - 83
        - 0
      - - 185
        - 0
      - - 205
        - 0
      - - 225
        - 0
      - - 245
        - 0
      - - 255
        - 0
    - episode_id: 167
      sample_frame:
      - - 1
        - 0
      - - 21
        - 0
      - - 41
        - 0
      - - 61
        - 0
      - - 81
        - 0
      - - 101
        - 0
      - - 121
        - 0
      - - 141
        - 0
      - - 145
        - 0
      - - 247
        - 0
      - - 267
        - 0
      - - 287
        - 0
      - - 307
        - 0
      - - 327
        - 0
      - - 347
        - 0
      - - 367
        - 0
      - - 378
        - 0
    vlm_eval: false
    # episode_stored : [{'episode_id': 157, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [34, 0], [34, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [136, 0], [136, 1], [141, 0], [141, 1], [156, 0], [156, 1], [161, 0], [161, 1], [164, 0], [164, 1], [176, 0], [176, 1], [196, 0], [196, 1], [216, 0], [216, 1], [236, 0], [236, 1], [256, 0], [256, 1], [266, 0], [266, 1], [276, 0], [276, 1], [286, 0], [286, 1], [296, 0], [296, 1], [306, 0], [306, 1], [316, 0], [316, 1], [326, 0], [326, 1], [336, 0], [336, 1], [346, 0], [346, 1], [348, 0], [348, 1]]}, {'episode_id': 134, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [60, 0], [60, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [108, 0], [108, 1], [162, 0], [162, 1], [182, 0], [182, 1], [202, 0], [202, 1], [210, 0], [210, 1], [222, 0], [222, 1], [230, 0], [230, 1], [242, 0], [242, 1], [250, 0], [250, 1], [262, 0], [262, 1], [270, 0], [270, 1], [282, 0], [282, 1], [290, 0], [290, 1], [302, 0], [302, 1], [310, 0], [310, 1], [322, 0], [322, 1], [326, 0], [326, 1]]}, {'episode_id': 9, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [133, 0], [133, 1], [183, 0], [183, 1], [203, 0], [203, 1], [223, 0], [223, 1], [235, 0], [235, 1], [243, 0], [243, 1], [255, 0], [255, 1], [263, 0], [263, 1], [275, 0], [275, 1], [283, 0], [283, 1], [295, 0], [295, 1], [303, 0], [303, 1], [315, 0], [315, 1], [323, 0], [323, 1], [335, 0], [335, 1], [343, 0], [343, 1], [342, 0], [342, 1]]}, {'episode_id': 52, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [48, 0], [48, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [136, 0], [136, 1], [150, 0], [150, 1], [170, 0], [170, 1], [190, 0], [190, 1], [210, 0], [210, 1], [230, 0], [230, 1], [238, 0], [238, 1], [250, 0], [250, 1], [258, 0], [258, 1], [270, 0], [270, 1], [278, 0], [278, 1], [290, 0], [290, 1], [298, 0], [298, 1], [310, 0], [310, 1], [318, 0], [318, 1], [330, 0], [330, 1], [335, 0], [338, 1], [335, 0], [335, 1]]}, {'episode_id': 123, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [124, 0], [124, 1], [141, 0], [141, 1], [156, 0], [156, 1], [226, 0], [226, 1], [246, 0], [246, 1], [258, 0], [258, 1], [266, 0], [266, 1], [278, 0], [278, 1], [286, 0], [286, 1], [298, 0], [298, 1], [306, 0], [306, 1], [318, 0], [318, 1], [326, 0], [326, 1], [338, 0], [338, 1], [346, 0], [346, 1], [358, 0], [358, 1], [366, 0], [366, 1], [378, 0], [378, 1], [386, 0], [386, 1], [398, 0], [398, 1], [406, 0], [406, 1], [418, 0], [418, 1], [426, 0], [426, 1], [438, 0], [438, 1], [442, 0], [442, 1]]}, {'episode_id': 32, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [66, 0], [66, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [129, 0], [129, 1], [168, 0], [168, 1], [188, 0], [188, 1], [208, 0], [208, 1], [228, 0], [228, 1], [231, 0], [231, 1], [248, 0], [248, 1], [251, 0], [251, 1], [268, 0], [268, 1], [271, 0], [271, 1], [274, 0], [274, 1]]}, {'episode_id': 28, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [98, 0], [98, 1], [101, 0], [101, 1], [121, 0], [121, 1], [129, 0], [129, 1], [200, 0], [200, 1], [220, 0], [220, 1], [231, 0], [231, 1], [240, 0], [240, 1], [251, 0], [251, 1], [260, 0], [260, 1], [271, 0], [271, 1], [280, 0], [280, 1], [291, 0], [291, 1], [295, 0], [295, 1]]}, {'episode_id': 145, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [69, 0], [69, 1], [81, 0], [81, 1], [99, 0], [99, 1], [171, 0], [171, 1], [191, 0], [191, 1], [201, 0], [201, 1], [211, 0], [211, 1], [209, 0], [209, 1]]}, {'episode_id': 71, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [48, 0], [48, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [136, 0], [136, 1], [150, 0], [150, 1], [170, 0], [170, 1], [190, 0], [190, 1], [210, 0], [210, 1], [230, 0], [230, 1], [238, 0], [238, 1], [250, 0], [250, 1], [258, 0], [258, 1], [265, 0], [265, 1]]}, {'episode_id': 54, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [86, 0], [86, 1], [101, 0], [101, 1], [121, 0], [121, 1], [134, 0], [134, 1], [188, 0], [188, 1], [208, 0], [208, 1], [228, 0], [228, 1], [236, 0], [236, 1], [248, 0], [248, 1], [246, 0], [246, 1]]}, {'episode_id': 88, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [37, 0], [37, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [105, 0], [105, 1], [139, 0], [139, 1], [159, 0], [159, 1], [179, 0], [179, 1], [199, 0], [199, 1], [207, 0], [207, 1], [219, 0], [219, 1], [227, 0], [227, 1], [239, 0], [239, 1], [247, 0], [247, 1], [259, 0], [259, 1], [267, 0], [267, 1], [279, 0], [279, 1], [287, 0], [287, 1], [290, 0], [290, 1]]}, {'episode_id': 111, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [83, 0], [83, 1], [88, 0], [88, 1], [185, 0], [185, 1], [190, 0], [190, 1], [205, 0], [205, 1], [210, 0], [210, 1], [225, 0], [225, 1], [230, 0], [230, 1], [245, 0], [245, 1], [250, 0], [250, 1], [265, 0], [265, 1], [270, 0], [270, 1], [285, 0], [285, 1], [290, 0], [290, 1], [291, 0], [291, 1]]}, {'episode_id': 50, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [50, 0], [50, 1], [61, 0], [61, 1], [81, 0], [81, 1], [92, 0], [92, 1], [152, 0], [152, 1], [172, 0], [172, 1], [192, 0], [192, 1], [194, 0], [194, 1], [212, 0], [212, 1], [214, 0], [214, 1], [232, 0], [232, 1], [234, 0], [234, 1], [252, 0], [252, 1], [254, 0], [254, 1], [272, 0], [272, 1], [274, 0], [274, 1], [292, 0], [292, 1], [294, 0], [294, 1], [292, 0], [292, 1]]}, {'episode_id': 18, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [60, 0], [60, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [147, 0], [147, 1], [162, 0], [162, 1], [182, 0], [182, 1], [202, 0], [202, 1], [222, 0], [222, 1], [242, 0], [242, 1], [249, 0], [249, 1], [262, 0], [262, 1], [269, 0], [269, 1], [267, 0], [267, 1]]}, {'episode_id': 90, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [59, 0], [59, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [142, 0], [142, 1], [161, 0], [161, 1], [181, 0], [181, 1], [201, 0], [201, 1], [221, 0], [221, 1], [241, 0], [241, 1], [244, 0], [244, 1], [261, 0], [261, 1], [264, 0], [264, 1], [267, 0], [267, 1]]}, {'episode_id': 34, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [46, 0], [46, 1], [60, 0], [60, 1], [148, 0], [148, 1], [162, 0], [162, 1], [168, 0], [168, 1], [182, 0], [182, 1], [188, 0], [188, 1], [202, 0], [202, 1], [208, 0], [208, 1], [222, 0], [222, 1], [228, 0], [228, 1], [242, 0], [242, 1], [248, 0], [248, 1], [257, 0], [257, 1]]}, {'episode_id': 86, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [66, 0], [66, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [161, 0], [161, 1], [168, 0], [168, 1], [188, 0], [188, 1], [208, 0], [208, 1], [228, 0], [228, 1], [248, 0], [248, 1], [268, 0], [268, 1], [270, 0], [270, 1], [288, 0], [288, 1], [290, 0], [290, 1], [308, 0], [308, 1], [310, 0], [310, 1], [328, 0], [328, 1], [330, 0], [330, 1], [348, 0], [348, 1], [350, 0], [350, 1], [356, 0], [356, 1]]}, {'episode_id': 60, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [88, 0], [88, 1], [101, 0], [101, 1], [120, 0], [120, 1], [190, 0], [190, 1], [210, 0], [210, 1], [222, 0], [222, 1], [230, 0], [230, 1], [242, 0], [242, 1], [250, 0], [250, 1], [262, 0], [262, 1], [270, 0], [270, 1], [282, 0], [282, 1], [290, 0], [290, 1], [302, 0], [302, 1], [310, 0], [310, 1], [308, 0], [308, 1]]}, {'episode_id': 81, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [51, 0], [51, 1], [61, 0], [61, 1], [81, 0], [81, 1], [153, 0], [153, 1], [173, 0], [173, 1], [183, 0], [183, 1], [193, 0], [193, 1], [203, 0], [203, 1], [213, 0], [213, 1], [214, 0], [214, 1]]}, {'episode_id': 159, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [49, 0], [49, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [151, 0], [151, 1], [152, 0], [152, 1], [171, 0], [171, 1], [191, 0], [191, 1], [211, 0], [211, 1], [231, 0], [231, 1], [251, 0], [251, 1], [254, 0], [254, 1], [271, 0], [271, 1], [274, 0], [274, 1], [291, 0], [291, 1], [294, 0], [294, 1], [311, 0], [311, 1], [314, 0], [314, 1], [331, 0], [331, 1], [334, 0], [334, 1], [337, 0], [337, 1]]}, {'episode_id': 156, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [56, 0], [56, 1], [61, 0], [61, 1], [81, 0], [81, 1], [86, 0], [86, 1], [158, 0], [158, 1], [178, 0], [178, 1], [188, 0], [188, 1], [198, 0], [198, 1], [208, 0], [208, 1], [218, 0], [218, 1], [228, 0], [228, 1], [238, 0], [238, 1], [248, 0], [248, 1], [258, 0], [258, 1], [268, 0], [268, 1], [278, 0], [278, 1], [288, 0], [288, 1], [298, 0], [298, 1], [302, 0], [302, 1]]}, {'episode_id': 13, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [56, 0], [56, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [139, 0], [139, 1], [158, 0], [158, 1], [178, 0], [178, 1], [198, 0], [198, 1], [218, 0], [218, 1], [238, 0], [238, 1], [241, 0], [241, 1], [258, 0], [258, 1], [261, 0], [261, 1], [278, 0], [278, 1], [281, 0], [281, 1], [298, 0], [298, 1], [301, 0], [301, 1], [318, 0], [318, 1], [321, 0], [321, 1], [322, 0], [322, 1]]}, {'episode_id': 147, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [79, 0], [79, 1], [81, 0], [81, 1], [86, 0], [86, 1], [181, 0], [181, 1], [188, 0], [188, 1], [201, 0], [201, 1], [208, 0], [208, 1], [221, 0], [221, 1], [228, 0], [228, 1], [241, 0], [241, 1], [248, 0], [248, 1], [261, 0], [261, 1], [268, 0], [268, 1], [273, 0], [273, 1]]}, {'episode_id': 139, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [63, 0], [63, 1], [81, 0], [81, 1], [101, 0], [101, 1], [104, 0], [104, 1], [165, 0], [165, 1], [185, 0], [185, 1], [205, 0], [205, 1], [206, 0], [206, 1], [225, 0], [225, 1], [226, 0], [226, 1], [245, 0], [245, 1], [246, 0], [246, 1], [265, 0], [265, 1], [266, 0], [266, 1], [285, 0], [285, 1], [286, 0], [286, 1], [305, 0], [305, 1], [306, 0], [306, 1], [309, 0], [309, 1]]}, {'episode_id': 39, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [86, 0], [86, 1], [163, 0], [163, 1], [183, 0], [183, 1], [188, 0], [188, 1], [203, 0], [203, 1], [208, 0], [208, 1], [220, 0], [223, 1], [220, 0], [220, 1]]}, {'episode_id': 151, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [56, 0], [56, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [134, 0], [134, 1], [158, 0], [158, 1], [178, 0], [178, 1], [198, 0], [198, 1], [218, 0], [218, 1], [236, 0], [236, 1], [238, 0], [238, 1], [256, 0], [256, 1], [258, 0], [258, 1], [276, 0], [276, 1], [278, 0], [278, 1], [296, 0], [296, 1], [298, 0], [298, 1], [316, 0], [316, 1], [318, 0], [318, 1], [316, 0], [316, 1]]}, {'episode_id': 146, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [74, 0], [74, 1], [81, 0], [81, 1], [90, 0], [90, 1], [176, 0], [176, 1], [192, 0], [192, 1], [196, 0], [196, 1], [212, 0], [212, 1], [216, 0], [216, 1], [232, 0], [232, 1], [236, 0], [236, 1], [252, 0], [252, 1], [256, 0], [256, 1], [272, 0], [272, 1], [276, 0], [276, 1], [292, 0], [292, 1], [290, 0], [290, 1]]}, {'episode_id': 25, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [56, 0], [56, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [149, 0], [149, 1], [158, 0], [158, 1], [178, 0], [178, 1], [198, 0], [198, 1], [218, 0], [218, 1], [238, 0], [238, 1], [251, 0], [251, 1], [258, 0], [258, 1], [271, 0], [271, 1], [278, 0], [278, 1], [291, 0], [291, 1], [298, 0], [298, 1], [304, 0], [304, 1]]}, {'episode_id': 153, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [114, 0], [114, 1], [121, 0], [121, 1], [216, 0], [216, 1], [223, 0], [223, 1], [236, 0], [236, 1], [243, 0], [243, 1], [256, 0], [256, 1], [263, 0], [263, 1], [276, 0], [276, 1], [283, 0], [283, 1], [296, 0], [296, 1], [303, 0], [303, 1], [316, 0], [316, 1], [323, 0], [323, 1], [336, 0], [336, 1], [343, 0], [343, 1], [350, 0], [350, 1]]}, {'episode_id': 161, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [104, 0], [104, 1], [121, 0], [121, 1], [133, 0], [133, 1], [206, 0], [206, 1], [226, 0], [226, 1], [235, 0], [235, 1], [246, 0], [246, 1], [255, 0], [255, 1], [262, 0], [262, 1]]}, {'episode_id': 144, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [111, 0], [111, 1], [213, 0], [213, 1], [233, 0], [233, 1], [253, 0], [253, 1], [273, 0], [273, 1], [272, 0], [272, 1]]}, {'episode_id': 115, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [56, 0], [56, 1], [143, 0], [143, 1], [158, 0], [158, 1], [163, 0], [163, 1], [178, 0], [178, 1], [183, 0], [183, 1], [198, 0], [198, 1], [203, 0], [203, 1], [209, 0], [209, 1]]}]
    # sample_info : [{'episode_id': 157, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [161, 0], [161, 1], [34, 0], [164, 1], [136, 0], [266, 1], [156, 0], [286, 1], [176, 0], [306, 1], [196, 0], [326, 1], [216, 0], [346, 1], [236, 0], [351, 1]]}, {'episode_id': 134, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 0], [81, 0], [81, 0], [101, 0], [101, 0], [108, 0], [60, 1], [210, 0], [162, 1], [230, 0], [182, 1], [250, 0], [202, 1], [270, 0], [222, 1], [290, 0], [242, 1], [310, 0], [262, 1], [329, 0], [282, 1]]}, {'episode_id': 9, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [80, 0], [133, 1], [80, 0], [235, 1], [100, 0], [255, 1], [120, 0], [275, 1], [140, 0], [295, 1], [160, 0], [315, 1], [180, 0], [335, 1], [200, 0], [345, 1], [220, 0], [298, 1], [240, 0], [298, 1], [260, 0], [298, 1], [280, 0], [298, 1], [300, 0], [298, 1]]}, {'episode_id': 52, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [48, 0], [136, 1], [150, 0], [238, 1], [170, 0], [258, 1], [190, 0], [278, 1], [210, 0], [298, 1], [230, 0], [318, 1], [250, 0], [338, 1], [270, 0], [338, 1]]}, {'episode_id': 123, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [124, 0], [156, 1], [226, 0], [258, 1], [246, 0], [278, 1], [266, 0], [298, 1], [286, 0], [318, 1], [306, 0], [338, 1], [326, 0], [358, 1], [346, 0], [378, 1], [366, 0], [398, 1], [386, 0], [418, 1], [406, 0], [438, 1], [426, 0], [445, 1]]}, {'episode_id': 32, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [66, 0], [129, 1], [168, 0], [231, 1], [188, 0], [251, 1], [208, 0], [271, 1], [228, 0], [277, 1]]}, {'episode_id': 28, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 0], [121, 0], [121, 0], [129, 0], [98, 1], [231, 0], [200, 1], [251, 0], [220, 1], [271, 0], [240, 1], [291, 0], [260, 1], [298, 0], [280, 1]]}, {'episode_id': 145, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 0], [99, 0], [69, 1], [201, 0], [171, 1], [212, 0], [191, 1], [230, 0], [211, 1]]}, {'episode_id': 71, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 0], [81, 0], [81, 0], [101, 0], [101, 0], [121, 0], [121, 0], [136, 0], [48, 1], [238, 0], [150, 1], [258, 0], [170, 1], [268, 0], [190, 1]]}, {'episode_id': 54, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [86, 0], [134, 1], [188, 0], [236, 1], [208, 0], [249, 1], [228, 0], [267, 1]]}, {'episode_id': 88, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [37, 0], [105, 1], [139, 0], [207, 1], [159, 0], [227, 1], [179, 0], [247, 1], [199, 0], [267, 1], [219, 0], [287, 1], [239, 0], [293, 1]]}, {'episode_id': 111, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [83, 0], [88, 1], [185, 0], [190, 1], [205, 0], [210, 1], [225, 0], [230, 1], [245, 0], [250, 1], [265, 0], [270, 1], [285, 0], [290, 1], [294, 0], [294, 1]]}, {'episode_id': 50, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 0], [81, 0], [81, 0], [92, 0], [50, 1], [194, 0], [152, 1], [214, 0], [172, 1], [234, 0], [192, 1], [254, 0], [212, 1], [274, 0], [232, 1], [294, 0], [252, 1], [295, 0], [272, 1]]}, {'episode_id': 18, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [60, 0], [147, 1], [162, 0], [249, 1], [182, 0], [269, 1], [202, 0], [270, 1]]}, {'episode_id': 90, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 0], [81, 0], [81, 0], [101, 0], [101, 0], [121, 0], [121, 0], [141, 0], [141, 0], [142, 0], [59, 1], [244, 0], [161, 1], [264, 0], [181, 1], [270, 0], [201, 1]]}, {'episode_id': 34, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [46, 0], [60, 1], [148, 0], [162, 1], [168, 0], [182, 1], [188, 0], [202, 1], [208, 0], [222, 1], [228, 0], [242, 1], [248, 0], [260, 1], [260, 0], [278, 1]]}, {'episode_id': 86, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [161, 0], [161, 1], [66, 0], [168, 1], [168, 0], [270, 1], [188, 0], [290, 1], [208, 0], [310, 1], [228, 0], [330, 1], [248, 0], [350, 1], [268, 0], [359, 1]]}, {'episode_id': 60, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 0], [120, 0], [88, 1], [222, 0], [190, 1], [242, 0], [210, 1], [262, 0], [230, 1], [282, 0], [250, 1], [302, 0], [270, 1], [311, 0], [290, 1], [329, 0], [310, 1]]}, {'episode_id': 159, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [49, 0], [152, 1], [151, 0], [254, 1], [171, 0], [274, 1], [191, 0], [294, 1], [211, 0], [314, 1], [231, 0], [334, 1], [251, 0], [340, 1]]}, {'episode_id': 156, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 0], [81, 0], [81, 0], [86, 0], [56, 1], [188, 0], [158, 1], [208, 0], [178, 1], [228, 0], [198, 1], [248, 0], [218, 1], [268, 0], [238, 1], [288, 0], [258, 1], [305, 0], [278, 1]]}, {'episode_id': 13, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [56, 0], [139, 1], [158, 0], [241, 1], [178, 0], [261, 1], [198, 0], [281, 1], [218, 0], [301, 1], [238, 0], [321, 1], [258, 0], [325, 1]]}, {'episode_id': 147, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [79, 0], [86, 1], [181, 0], [188, 1], [201, 0], [208, 1], [221, 0], [228, 1], [241, 0], [248, 1], [261, 0], [268, 1], [276, 0], [276, 1]]}, {'episode_id': 139, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [63, 0], [104, 1], [165, 0], [206, 1], [185, 0], [226, 1], [205, 0], [246, 1], [225, 0], [266, 1], [245, 0], [286, 1], [265, 0], [306, 1], [285, 0], [312, 1]]}, {'episode_id': 39, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 0], [81, 0], [81, 0], [86, 0], [60, 1], [188, 0], [60, 1], [208, 0], [80, 1], [223, 0], [100, 1], [178, 0], [120, 1], [178, 0], [140, 1], [178, 0], [160, 1], [178, 0], [180, 1], [178, 0], [200, 1]]}, {'episode_id': 151, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [56, 0], [134, 1], [158, 0], [236, 1], [178, 0], [256, 1], [198, 0], [276, 1], [218, 0], [296, 1], [238, 0], [316, 1], [258, 0], [319, 1]]}, {'episode_id': 25, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 1], [141, 0], [141, 1], [56, 0], [149, 1], [158, 0], [251, 1], [178, 0], [271, 1], [198, 0], [291, 1], [218, 0], [307, 1]]}, {'episode_id': 153, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [120, 0], [114, 1], [120, 0], [216, 1], [140, 0], [236, 1], [160, 0], [256, 1], [180, 0], [276, 1], [200, 0], [296, 1], [220, 0], [316, 1], [240, 0], [336, 1], [260, 0], [353, 1], [280, 0], [298, 1], [300, 0], [298, 1], [320, 0], [298, 1], [340, 0], [298, 1], [353, 0], [298, 1]]}, {'episode_id': 161, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [121, 0], [121, 0], [133, 0], [104, 1], [235, 0], [206, 1], [255, 0], [226, 1], [265, 0], [246, 1]]}, {'episode_id': 144, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 1], [61, 0], [61, 1], [81, 0], [81, 1], [101, 0], [101, 1], [111, 0], [111, 1], [213, 0], [213, 1], [233, 0], [233, 1], [253, 0], [253, 1], [273, 0], [273, 1], [275, 0], [275, 1]]}, {'episode_id': 115, 'sample_frame': [[1, 0], [1, 1], [21, 0], [21, 1], [41, 0], [41, 0], [56, 0], [40, 1], [158, 0], [40, 1], [178, 0], [60, 1], [198, 0], [80, 1], [212, 0], [100, 1], [158, 0], [120, 1], [158, 0], [140, 1], [158, 0], [160, 1], [158, 0], [180, 1], [158, 0], [200, 1]]}]
    # sample_info : []

  rl:
    agent:
      type: MultiAgentAccessMgr
      num_agent_types: 2
      num_active_agents_per_type: [1, 1]
      num_pool_agents_per_type: [1, 1]
      agent_sample_interval: 20
      force_partner_sample_idx: -1
      use_llm_agent: true
    policy:
      agent_0:
        hierarchical_policy:
          high_level_policy:
            termination_obs_name: agents_within_threshold
            add_arm_rest: false
            policy_input_keys:
            - articulated_agent_arm_rgb
            - articulated_agent_arm_depth
            - is_holding
            - obj_start_gps_compass
            - obj_goal_gps_compass
            - other_agent_gps
            - obj_start_sensor
            - obj_goal_sensor
            - all_predicates
            allowed_actions:
            - wait
            - nav_to_goal
            - nav_to_obj
            - nav_to_goal_dog
            - pick
            - place
            - nav_to_receptacle_by_name
          # Override to use the oracle navigation skill (which will actually execute navigation).
          defined_skills:
            nav_to_obj:
              skill_name: OracleNavPolicy
              # action_name: "base_velocity_non_cylinder"
              action_name: base_velocity
              obs_skill_inputs: [obj_start_sensor, abs_obj_start_sensor, obj_goal_sensor,
                abs_obj_goal_sensor]
              max_skill_steps: 1500
            pick:
              skill_name: OraclePickPolicy
              action_name: arm_pick_action
              obs_skill_inputs: [is_holding]
              max_skill_steps: 100
            place:
              skill_name: OraclePlacePolicy
              action_name: arm_place_action
              obs_skill_inputs: []
              max_skill_steps: 100
            reset_arm:
              skill_name: ResetArmSkill
              action_name: arm_reset_action
              obs_skill_inputs: []
              max_skill_steps: 100

          ignore_skills:
          - open_cab
          - open_fridge
          - close_cab
          - close_fridge
      agent_1:
        hierarchical_policy:
          high_level_policy:
            termination_obs_name: agents_within_threshold
            add_arm_rest: false
            policy_input_keys:
            - articulated_agent_arm_rgb
            - articulated_agent_arm_depth
            - is_holding
            - obj_start_gps_compass
            - obj_goal_gps_compass
            - other_agent_gps
            - obj_start_sensor
            - obj_goal_sensor
            - all_predicates
            allowed_actions:
            - wait
            - nav_to_goal
            - nav_to_obj
            - nav_to_goal_dog
            - pick
            - place
            - nav_to_receptacle_by_name
          # Override to use the oracle navigation skill (which will actually execute navigation).
          defined_skills:
            nav_to_obj:
              skill_name: OracleNavPolicy
              # action_name: "base_velocity_non_cylinder"
              action_name: base_velocity
              obs_skill_inputs: [obj_start_sensor, abs_obj_start_sensor, obj_goal_sensor,
                abs_obj_goal_sensor]
              max_skill_steps: 1500
            pick:
              skill_name: OraclePickPolicy
              action_name: arm_pick_action
              obs_skill_inputs: [is_holding]
              max_skill_steps: 100
            place:
              skill_name: OraclePlacePolicy
              action_name: arm_place_action
              obs_skill_inputs: []
              max_skill_steps: 100
            reset_arm:
              skill_name: ResetArmSkill
              action_name: arm_reset_action
              obs_skill_inputs: []
              max_skill_steps: 100

          ignore_skills:
          - open_cab
          - open_fridge
          - close_cab
          - close_fridge

    ppo:
      # ppo params
      clip_param: 0.2
      ppo_epoch: 1
      num_mini_batch: 2
      value_loss_coef: 0.5
      entropy_coef: 0.0001
      lr: 2.5e-4
      eps: 1e-5
      max_grad_norm: 0.2
      num_steps: 128
      use_gae: true
      gamma: 0.99
      tau: 0.95

    ddppo:
      sync_frac: 0.6
      # The PyTorch distributed backend to use
      distrib_backend: NCCL
      # Visual encoder backbone
      pretrained_weights: data/ddppo-models/gibson-2plus-resnet50.pth
      # Initialize with pretrained weights
      pretrained: false
      # Initialize just the visual encoder backbone with pretrained weights
      pretrained_encoder: false
      # Whether the visual encoder backbone will be trained.
      train_encoder: true
      # Whether to reset the critic linear layer
      reset_critic: false
      # Model parameters
      backbone: resnet18
      rnn_type: LSTM
      num_recurrent_layers: 2
